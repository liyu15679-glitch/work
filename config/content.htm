<h1>About</h1>
<p>課程名稱: 計算機程式</p>
<p><span>個人倉儲：</span><a href="https://github.com/liyu15679-glitch/work">https://github.com/liyu15679-glitch/work</a></p>
<p><span>個人網站：<a href="https://liyu15679-glitch.github.io/work/content/index.html">https://liyu15679-glitch.github.io/work/content/index.html</a></span></p>
<p><span>程式操作影片:<a href="https://www.youtube.com/watch?v=DpX1SymUuSU">https://www.youtube.com/watch?v=DpX1SymUuSU</a></span></p>
<p>課程評分:</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">學習心得報告 (60%)</span> - MS Teams 線上參與，<span style="background-color: #ccffcc;">6人一組</span>每三週發表學習心得。</p>
<p style="padding-left: 60px;">w3、w7、w10、w14、w17、w18</p>
<p style="padding-left: 60px;">學習心得報告主題:</p>
<p style="padding-left: 60px;">w3: 什麼是 git, GitHub, gist 與 cmsimde? 如何使用這些工具？為什麼要使用這些工具？ (<a href="https://mde.tw/cp2025/content/Brython.html?src=https://gist.githubusercontent.com/mdecycu/71ff1c69dd233e6a5a83dd60997950de/raw/b4134dc3724f9c6aa1de7534a74f298288de0fa5/round_dot_move.py">動態模擬</a>)</p>
<p style="padding-left: 60px;">w7: Brython 是什麼？如何在瀏覽器配置 Brython 環境？ Brython 能做什麼？ (<a href="https://mde.tw/cp2025/content/Brython.html">Brython</a>, <a href="https://mde.tw/cp2025/content/Robot_ex.html">Examples</a>)</p>
<p style="padding-left: 60px;">w10: 如何在瀏覽器中模擬機器人作動？ (<a href="https://mde.tw/cp2025/content/Brython.html?src=https://gist.githubusercontent.com/mdecycu/58fed8bd2f5be98a6456a8dcae512011/raw/4019adba4ee4be19c35982d835bad8e7d83a7b2f/brython_robot4_ex1.py">機器人作動</a>)</p>
<p style="padding-left: 60px;">w14: 在瀏覽器中模擬機器人作動的目的是什麼？ (<a href="/downloads/otto_robot.7z">otto_robot.7z</a>, <a href="https://mde.tw/cad2025/content/Homework.html">Plotter</a>, <a href="/downloads/open_duck_mini.7z">open_duck_mini.7z</a> ,<a href="https://webots.cloud/AcTNYs0">https://webots.cloud/AcTNYs0</a>)</p>
<p style="padding-left: 60px;">w17 (<span style="background-color: #ccffcc;">1b 採 Youtube 影片簡報</span>): 計算機程式課程學到了什麼？</p>
<p style="padding-left: 60px;">w18: 課程總結</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">個人與分組網站維護 (40%)</span> - 每週至少兩次推送與課程進度相關的學習內容與心得。</p>
<p style="padding-left: 60px;">w9 期中自評、w18 期末自評</p>
<h1 style="padding-left: 60px;">學習心得報告</h1>
<h2>w3</h2>
<p><strong><span style="background-color: #ffffff;">什麼是 git? 為什麼要用git?</span></strong></p>
<p><span style="background-color: #ffffff;">　　Git 是一套分散式版本控制系統（Distributed Version Control System, DVCS），</span>主要功能在於協助開發者進行版本管理。當專案中的檔案隨著時間不斷被修改時，Git 會完整記錄每一次變更，形成可追溯的歷史紀錄。透過這些紀錄，使用者可以清楚知道是誰在什麼時間點修改了哪些內容，並且在需要時隨時回復到過去的任一版本，避免因錯誤修改而造成無法挽回的損失。</p>
<p data-end="315" data-start="181">　　除了版本控管之外，Git 也大幅提升了多人協作的效率。在團隊開發情境中，多位成員可以同時對同一個專案進行開發，各自提交自己的變更。Git 會在整合這些變更時協助處理合併的流程，並在發生衝突時明確指出問題位置，讓團隊成員能有系統地解決衝突，而不必擔心彼此覆蓋對方的成果。</p>
<p data-end="423" data-start="317">　　此外，Git 也是一項重要的風險控管工具。開發者可以透過分支機制，在不影響主要穩定版本的情況下嘗試新功能或進行實驗性修改。即使開發方向不如預期，也能輕易捨棄該分支，不會對主程式造成影響，從而降低開發過程中的風險。</p>
<p data-path-to-node="10">在 Git 的世界裡，檔案通常會經歷三個主要的區域：</p>
<p data-path-to-node="10"><b data-index-in-node="0" data-path-to-node="11,0,0">  1.工作目錄 (Working Directory)</b>：你正在編輯檔案的地方（就是你的資料夾）。</p>
<p data-path-to-node="10"><b data-index-in-node="0" data-path-to-node="11,1,0">  2.暫存區 (Staging Area)</b>：你挑選準備要存檔的檔案（像是購物車，還沒結帳）。</p>
<p data-path-to-node="10"><b data-index-in-node="0" data-path-to-node="11,2,0">  3.本地儲存庫 (Local Repository)</b>：正式存檔紀錄的地方（按下 Commit 後，這份快照就會永久保存）。</p>
<p data-path-to-node="10"><strong>什麼是GitHub?　為什麼要用GitHub？</strong></p>
<p data-end="87" data-start="0">　　GitHub 是一個<strong data-end="36" data-start="10">以 Git 為基礎的雲端程式碼託管與協作平台</strong>。它的主要目的，是讓開發者能夠把使用 Git 管理的專案放到網路上，並在此基礎上進行分享、協作與管理。</p>
<p data-end="238" data-start="89">　　GitHub 提供了一個集中式的遠端空間，讓個人或團隊可以安全地儲存專案的完整版本歷史。開發者在自己的電腦上使用 Git 進行開發與提交之後，可以將這些變更推送到 GitHub，使專案在雲端保持同步。即使更換電腦或多人同時參與開發，也能確保所有人都基於同一份最新且可追溯的程式碼進行工作。</p>
<p data-end="379" data-start="240">　　除了單純存放程式碼之外，GitHub 更強調「協作」這件事。平台提供了如 Pull Request、Issue 與 Code Review 等機制，讓團隊成員能夠在正式合併程式碼之前進行討論、審查與修改。這種工作流程不僅能降低錯誤進入主程式的風險，也讓開發過程更透明、更有制度。</p>
<p data-end="500" data-start="381">　　GitHub 同時也是全球最大的開源社群之一。許多知名的開源專案都託管在 GitHub 上，任何人都可以查看原始碼、提出建議，甚至貢獻程式碼。對學習者而言，GitHub 不只是工具，更是一個可以觀摩實務專案、累積作品與建立技術履歷的平台。</p>
<p data-end="591" data-is-last-node="" data-is-only-node="" data-start="502">　　簡而言之，<strong data-end="567" data-start="507">Git 是負責「如何管理版本的工具」，而 GitHub 則是讓這些 Git 專案「被放在網路上並進行協作的服務」</strong>。兩者經常一起使用，但本質上扮演的是不同的角色。</p>
<p data-end="26" data-start="0">以下以<strong data-end="10" data-start="3">條列式</strong>說明為什麼要使用 GitHub：</p>
<ul data-end="328" data-start="28">
<li data-end="79" data-start="28">
<p data-end="79" data-start="30"><strong data-end="42" data-start="30">雲端備份與安全性</strong><br data-end="45" data-start="42"/> 專案與完整版本歷史存放在雲端，即使電腦損壞或遺失，也能隨時取回。</p>
</li>
<li data-end="132" data-start="81">
<p data-end="132" data-start="83"><strong data-end="93" data-start="83">多人協作開發</strong><br data-end="96" data-start="93"/> 多位成員可同時開發同一專案，透過平台機制整合修改，避免互相覆蓋檔案。</p>
</li>
<li data-end="185" data-start="134">
<p data-end="185" data-start="136"><strong data-end="150" data-start="136">清楚的版本與修改紀錄</strong><br data-end="153" data-start="150"/> 每一次變更都有紀錄，可追蹤是誰修改、何時修改，以及修改內容。</p>
</li>
<li data-end="238" data-start="187">
<p data-end="238" data-start="189"><strong data-end="203" data-start="189">程式碼審查與討論機制</strong><br data-end="206" data-start="203"/> 在合併程式碼前可進行討論與檢查，降低錯誤進入正式版本的風險。</p>
</li>
<li data-end="283" data-start="240">
<p data-end="283" data-start="242"><strong data-end="254" data-start="242">成果展示與作品集</strong><br data-end="257" data-start="254"/> 專案可公開展示，作為學習成果或求職時的技術作品。</p>
</li>
<li data-end="328" data-start="285">
<p data-end="328" data-start="287"><strong data-end="300" data-start="287">大量開源與學習資源</strong><br data-end="303" data-start="300"/> 可閱讀他人專案、學習實務寫法，並參與開源社群。</p>
</li>
</ul>
<p data-end="591" data-is-last-node="" data-is-only-node="" data-start="502"><strong>什麼是gist ?</strong></p>
<p data-end="94" data-start="0">　　Gist 是 GitHub 提供的一個簡單工具，用來快速分享少量的程式碼或文字內容。它適合在不需要建立完整專案的情況下，把一段程式碼、設定檔或範例直接放到網路上，並產生一個可以分享的連結。</p>
<p data-end="181" data-is-last-node="" data-is-only-node="" data-start="96">　　雖然操作上非常簡單，但每個 Gist 仍然具備 Git 的版本紀錄功能，因此內容被修改時也能保留歷史。整體而言，Gist 就是用來「快速貼程式碼、快速分享」的輕量化服務。</p>
<p data-end="181" data-is-last-node="" data-is-only-node="" data-start="96"><strong>什麼是cmsimde? </strong></p>
<p data-end="106" data-start="0">　　<strong>cmsimde</strong>是一套<strong data-end="38" data-start="11">用來建立與管理課程或專案網站的簡易內容管理系統</strong>，常見於工程或程式相關的教學環境中。它的主要用途，是讓使用者能用結構化的方式撰寫與整理網頁內容，例如課程說明、作業、技術文件或學習紀錄。</p>
<p data-end="235" data-is-last-node="" data-is-only-node="" data-start="108">　　在實際使用上，CMSiMDE 通常搭配 Git 來管理內容版本，因此每一次修改都可以被追蹤與回復。它並不是像 WordPress 那樣面向一般商業網站的系統，而是偏向<strong data-end="202" data-start="191">教學與技術用途</strong>，強調內容可控、版本清楚，以及方便學生或開發者維護個人或課程網站。</p>
<h2>ｗ７</h2>
<p><strong>Brython 是什麼？</strong></p>
<p data-end="197" data-start="56"><strong data-end="67" data-start="56">Brython</strong>（Browser Python 的縮寫）是一個用於瀏覽器的 <strong data-end="111" data-start="97">Python 直譯器</strong>，可以讓你在 <strong data-end="141" data-start="118">網頁端直接使用 Python 撰寫腳本</strong>，而不需要透過 JavaScript。它會把 Python 代碼轉換成 JavaScript，並在瀏覽器中執行。</p>
<ul data-end="359" data-start="199">
<li data-end="252" data-start="199">
<p data-end="252" data-start="201">官方網站：<a class="decorated-link" data-end="250" data-start="206" href="https://brython.info" rel="noopener" target="_new">https://brython.info<span aria-hidden="true" class="ms-0.5 inline-block align-middle leading-none"><svg aria-hidden="true" class="block h-[0.75em] w-[0.75em] stroke-current stroke-[0.75]" data-rtl-flip="" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><use fill="currentColor" href="/cdn/assets/sprites-core-i9agxugi.svg#304883"></use></svg></span></a></p>
</li>
<li data-end="292" data-start="253">
<p data-end="292" data-start="255">支援的 Python 版本：目前大約是 <strong data-end="290" data-start="275">Python 3.9+</strong></p>
</li>
<li data-end="359" data-start="293">
<p data-end="359" data-start="295">主要目標：讓 Python 能夠操作 DOM、事件、AJAX、Canvas 等瀏覽器 API，就像 JavaScript 一樣。</p>
</li>
</ul>
<p data-end="408" data-start="361">簡單理解：<strong data-end="407" data-start="366">Brython = Python → JavaScript → 瀏覽器執行</strong>。</p>
<p data-end="408" data-start="361"><strong>如何在瀏覽器配置 Brython 環境？</strong></p>
<p data-end="463" data-start="443">Brython 非常輕量，配置方法如下：</p>
<h3 data-end="500" data-start="465">步驟 1：引入 Brython 的 JavaScript 檔案</h3>
<p data-end="513" data-start="502">可以使用官方 CDN：</p>
<div class="contain-inline-size rounded-2xl corner-superellipse/1.1 relative bg-token-sidebar-surface-primary">
<div class="sticky top-[calc(--spacing(9)+var(--header-height))] @w-xl/main:top-9">
<div class="absolute end-0 bottom-0 flex h-9 items-center pe-2">
<div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div>
</div>
</div>
<div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"text/javascript"</span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/brython@3.11.1/brython.min.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt; </span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"text/javascript"</span></span><span> </span><span><span class="hljs-attr">src</span></span><span>=</span><span><span class="hljs-string">"https://cdn.jsdelivr.net/npm/brython@3.11.1/brython_stdlib.js"</span></span><span>&gt;</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt; </span></span></code></div>
</div>
<ul data-end="830" data-start="743">
<li data-end="768" data-start="743">
<p data-end="768" data-start="745"><code data-end="761" data-start="745">brython.min.js</code>：核心引擎</p>
</li>
<li data-end="830" data-start="769">
<p data-end="830" data-start="771"><code data-end="790" data-start="771">brython_stdlib.js</code>：標準庫支持（如 <code data-end="805" data-start="799">math</code>, <code data-end="815" data-start="807">random</code>, <code data-end="827" data-start="817">datetime</code> 等）</p>
</li>
</ul>
<p><br/>步驟 2：在 <code data-end="851" data-start="843">&lt;body&gt;</code> 標籤加上啟動 Brython</p>
<div class="contain-inline-size rounded-2xl corner-superellipse/1.1 relative bg-token-sidebar-surface-primary">
<div class="sticky top-[calc(--spacing(9)+var(--header-height))] @w-xl/main:top-9">
<div class="absolute end-0 bottom-0 flex h-9 items-center pe-2">
<div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div>
</div>
</div>
<div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-tag">&lt;<span class="hljs-name">body</span></span></span><span> </span><span><span class="hljs-attr">onload</span></span><span>=</span><span><span class="hljs-string">"brython()"</span></span><span>&gt; ... </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span></span></span><span>&gt; </span></span></code></div>
</div>
<h3 data-end="944" data-start="923">步驟 3：撰寫 Python 代碼</h3>
<p data-end="979" data-start="946">使用 <code data-end="978" data-start="949">&lt;script type="text/python"&gt;</code>：</p>
<div class="contain-inline-size rounded-2xl corner-superellipse/1.1 relative bg-token-sidebar-surface-primary">
<div class="sticky top-[calc(--spacing(9)+var(--header-height))] @w-xl/main:top-9">
<div class="absolute end-0 bottom-0 flex h-9 items-center pe-2">
<div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div>
</div>
</div>
<div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-html"><span><span><span class="hljs-tag">&lt;<span class="hljs-name">script</span></span></span><span> </span><span><span class="hljs-attr">type</span></span><span>=</span><span><span class="hljs-string">"text/python"</span></span><span>&gt;<span class="language-javascript"> </span></span><span><span class="hljs-keyword">from</span></span><span> browser </span><span><span class="hljs-keyword">import</span></span><span> </span><span><span class="hljs-variable language_">document</span></span><span>, alert def </span><span><span class="hljs-title function_">hello</span></span><span>(event): </span><span><span class="hljs-title function_">alert</span></span><span>(</span><span><span class="hljs-string">"Hello from Brython!"</span></span><span>) </span><span><span class="hljs-variable language_">document</span></span><span>[</span><span><span class="hljs-string">'mybutton'</span></span><span>].</span><span><span class="hljs-title function_">bind</span></span><span>(</span><span><span class="hljs-string">'click'</span></span><span>, hello) </span><span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span></span></span><span>&gt; </span><span><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span> </span><span><span class="hljs-attr">id</span></span><span>=</span><span><span class="hljs-string">"mybutton"</span></span><span>&gt;Click me!</span><span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span></span></span><span>&gt; </span></span></code></div>
</div>
<ul data-end="1283" data-start="1205">
<li data-end="1243" data-start="1205">
<p data-end="1243" data-start="1207">這個範例中，Python 操作 DOM，監聽按鈕點擊事件，並彈出提示框。</p>
</li>
<li data-end="1283" data-start="1244">
<p data-end="1283" data-start="1246">你可以直接在瀏覽器中開啟 <code data-end="1266" data-start="1259">.html</code> 文件，Brython 就能運行。</p>
</li>
</ul>
<p data-end="1360" data-start="1312"><strong>Brython 能做什麼？</strong></p>
<p data-end="1360" data-start="1312">Brython 的主要用途是<strong data-end="1334" data-start="1326">前端開發</strong>，可以用 Python 替代 JavaScript：</p>
<ol data-end="1800" data-start="1362">
<li data-end="1472" data-start="1362">
<p data-end="1375" data-start="1365"><strong data-end="1375" data-start="1365">操作 DOM</strong></p>
<div class="contain-inline-size rounded-2xl corner-superellipse/1.1 relative bg-token-sidebar-surface-primary">
<div class="sticky top-[calc(--spacing(9)+var(--header-height))] @w-xl/main:top-9">
<div class="absolute end-0 bottom-0 flex h-9 items-center pe-2">
<div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div>
</div>
</div>
<div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre! language-python"><span><span><span class="hljs-keyword">from</span></span><span> browser </span><span><span class="hljs-keyword">import</span></span><span> document document[</span><span><span class="hljs-string">'mydiv'</span></span><span>].text = </span><span><span class="hljs-string">"Hello Brython!"</span></span><span> </span></span></code></div>
</div>
</li>
<li data-end="1515" data-start="1473">
<p data-end="1484" data-start="1476"><strong data-end="1484" data-start="1476">事件處理</strong></p>
<ul data-end="1515" data-start="1488">
<li data-end="1515" data-start="1488">
<p data-end="1515" data-start="1490">點擊、鍵盤、滑鼠事件等都能用 Python 綁定。</p>
</li>
</ul>
</li>
<li data-end="1581" data-start="1516">
<p data-end="1537" data-start="1519"><strong data-end="1537" data-start="1519">AJAX / HTTP 請求</strong></p>
<ul data-end="1581" data-start="1541">
<li data-end="1581" data-start="1541">
<p data-end="1581" data-start="1543">使用 <code data-end="1560" data-start="1546">browser.ajax</code> 或第三方庫發送 GET/POST 請求。</p>
</li>
</ul>
</li>
<li data-end="1629" data-start="1582">
<p data-end="1598" data-start="1585"><strong data-end="1598" data-start="1585">Canvas 繪圖</strong></p>
<ul data-end="1629" data-start="1602">
<li data-end="1629" data-start="1602">
<p data-end="1629" data-start="1604">操作 HTML5 Canvas 進行 2D 繪圖。</p>
</li>
</ul>
</li>
<li data-end="1697" data-start="1630">
<p data-end="1645" data-start="1633"><strong data-end="1645" data-start="1633">數學計算與標準庫</strong></p>
<ul data-end="1697" data-start="1649">
<li data-end="1697" data-start="1649">
<p data-end="1697" data-start="1651">使用 Python 標準庫，例如 <code data-end="1674" data-start="1668">math</code>, <code data-end="1684" data-start="1676">random</code>, <code data-end="1696" data-start="1686">datetime</code>。</p>
</li>
</ul>
</li>
<li data-end="1742" data-start="1698">
<p data-end="1712" data-start="1701"><strong data-end="1712" data-start="1701">簡單遊戲或動畫</strong></p>
<ul data-end="1742" data-start="1716">
<li data-end="1742" data-start="1716">
<p data-end="1742" data-start="1718">與 Canvas、事件配合，可以做小型前端遊戲。</p>
</li>
</ul>
</li>
<li data-end="1800" data-start="1743">
<p data-end="1754" data-start="1746"><strong data-end="1754" data-start="1746">教育用途</strong></p>
<ul data-end="1800" data-start="1758">
<li data-end="1800" data-start="1758">
<p data-end="1800" data-start="1760">適合教 Python 語法，不需要學生學 JavaScript 即可操作瀏覽器。</p>
</li>
</ul>
</li>
</ol>
<hr data-end="1805" data-start="1802"/>
<h3 data-end="1814" data-start="1807">總結：</h3>
<ul data-end="1944" data-start="1816">
<li data-end="1848" data-start="1816">
<p data-end="1848" data-start="1818"><strong data-end="1846" data-start="1818">Brython = Python 在瀏覽器中運行</strong></p>
</li>
<li data-end="1914" data-start="1849">
<p data-end="1914" data-start="1851"><strong data-end="1859" data-start="1851">配置簡單</strong>：引入 CDN → <code data-end="1898" data-start="1869">&lt;script type="text/python"&gt;</code> → <code data-end="1912" data-start="1901">brython()</code></p>
</li>
<li data-end="1944" data-start="1915">
<p data-end="1944" data-start="1917"><strong data-end="1923" data-start="1917">用途</strong>：前端開發、互動網頁、教育、簡單遊戲或動畫</p>
</li>
</ul>
<p></p>
<h2>w10</h2>
<h2>w14</h2>
<h2>w17</h2>
<h2>w18</h2>
<p></p>
<h1>Brython</h1>
<p><a href="https://brython.info/">Brython</a> 是一個將 <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> 語法編譯為 <a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript">JavaScript</a> 的工具，能直接在瀏覽器中以 <a href="https://en.wikipedia.org/wiki/Python_(programming_language)">Python</a> 撰寫前端網頁程式。</p>
<p><button id="add1to100">1 add to 100</button><button id="robot1">機器人巡邏</button><button id="free_walk">自由行</button></p>
<!-- 導入 brython 程式庫 -->
<p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
</p>
<!-- 啟動 Brython -->
<p>
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/','./../downloads/py/']});
}
</script>
</p>
<p><!-- 導入 FileSaver 與 filereader --></p>
<p>
<script src="/static/ace/FileSaver.min.js" type="text/javascript"></script>
<script src="/static/ace/filereader.js" type="text/javascript"></script>
</p>
<p><!-- 導入 ace --></p>
<p>
<script src="/static/ace/ace.js" type="text/javascript"></script>
<script src="/static/ace/ext-language_tools.js" type="text/javascript"></script>
<script src="/static/ace/mode-python3.js" type="text/javascript"></script>
<script src="/static/ace/snippets/python.js" type="text/javascript"></script>
</p>
<p><!-- 導入 gearUtils-0.9.js Cango 齒輪繪圖程式庫 -->
<script src="/static/Cango-24v03-min.js"></script>
<script src="/static/gearUtils-09.js"></script>
<script src="/static/SVGpathUtils-6v03-min.js"></script>
<script src="/static/sylvester.js"></script>
<script src="/static/PrairieDraw.js"></script>
</p>
<p><!-- 請注意, 這裡使用 Javascript 將 localStorage["kw_py_src1"] 中存在近端瀏覽器的程式碼, 由使用者決定存檔名稱--></p>
<p>
<script type="text/javascript">
function doSave(storage_id, filename){
    var blob = new Blob([localStorage[storage_id]], {type: "text/plain;charset=utf-8"});
    filename = document.getElementById(filename).value
    saveAs(blob, filename+".py");
}
</script>
</p>
<p><!-- 累加程式開始 -->
<script type="text/python3">
from browser import document as doc
import ace
# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()
Ace1 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )
# 從 gist 取出程式碼後, 放入 editor 作為 default 程式
def run1():
    # 利用 get 取下 src 變數值
    try:
        url = doc.query["src"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # 將程式載入編輯區
    Ace1.editor.setValue(prog)
    Ace1.editor.scrollToRow(0)
    Ace1.editor.gotoLine(0)
    # 直接執行程式
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # 按下 run 按鈕
    Ace1.run()
# 執行程式, 顯示輸出結果與清除輸出結果及對應按鈕綁定
doc['kw_run1'].bind('click', Ace1.run)
doc['kw_show_console1'].bind('click', Ace1.show_console)
doc['kw_clear_console1'].bind('click', Ace1.clear_console)
doc['clear_bd1'].bind('click', clear_bd1)
# 呼叫函式執行
run1()
</script>
<!-- 累加程式結束 --> <!-- 機器人巡邏程式開始 -->
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

robot1_url = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/b33c5fc2a0774f8c5d2b0e8c7c7908e58d73bb94/robot_1.py"

# 從 gist 取得程式碼
robot1_src = open(robot1_url).read()
def robot1(ev):
    Ace2.editor.setValue(robot1_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id 為 "robot1" 的按鈕點按時, 執行 robot1 方法
doc["robot1"].bind('click', robot1)
</script>
<!-- 機器人巡邏程式結束 --></p>
<!-- 機器人自由行程式開始 -->
<p>
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

free_walk_url = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9d55811467e411eb89f74171d8a586ae9f1a96aa/brython_robot_free_walk.py"

# 從 gist 取得程式碼
free_walk_src = open(free_walk_url).read()
def free_walk(ev):
    Ace2.editor.setValue(free_walk_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id 為 "free_walk" 的按鈕點按時, 執行 robot1 方法
doc["free_walk"].bind('click', free_walk)
</script>
</p>
<!-- 機器人自由行程式結束 -->
<p><!-- add 1 to 100 開始 -->
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# 從 gist 取得程式碼
add_src = open(add1to100_url).read()
def add(ev):
    Ace2.editor.setValue(add_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id 為 "add1to100" 的按鈕點按時, 執行 add 方法
doc["add1to100"].bind('click', add)
</script>
</p>
<p><!-- add 1 to 100 結束--></p>
<!-- editor1 開始 -->
<p><!-- 用來顯示程式碼的 editor 區域 --></p>
<div id="kw_editor1" style="width: 600px; height: 300px;"></div>
<p><!-- 以下的表單與按鈕與前面的 Javascript doSave 函式以及 FileSaver.min.js 互相配合 --></p>
<p><!-- 存擋表單開始 --></p>
<form><label>Filename: <input id="kw_filename" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src1', 'kw_filename1');" type="submit" value="Save"/></form>
<p><!-- 存擋表單結束 --></p>
<p></p>
<p><!-- 執行與清除按鈕開始 --></p>
<p><button id="kw_run1">Run</button> <button id="kw_show_console1">Output</button> <button id="kw_clear_console1">清除輸出區</button><button id="clear_bd1">清除繪圖區</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- 執行與清除按鈕結束 --></p>
<p></p>
<p><!-- 程式執行 ouput 區 --></p>
<div style="width: 100%; height: 100%;"><textarea autocomplete="off" id="kw_console1"></textarea></div>
<p><!-- Brython 程式執行的結果, 都以 brython_div1 作為切入位置 --></p>
<div id="brython_div1"></div>
<!-- editor1 結束 --><hr/><!-- ########################################## -->
<p>從 1 累加到 100 part2:</p>
<p><button id="add1to100part2">1 add to 100</button><button id="cango_three_gears">cango_three_gears</button><button id="bsnake">BSnake</button><button id="aitetris">AI Tetris</button></p>
<p><!-- 請注意, 這裡使用 Javascript 將 localStorage["kw_py_src2"] 中存在近端瀏覽器的程式碼, 由使用者決定存檔名稱--></p>
<p>
<script type="text/python3">
from browser import document as doc
import ace
# 清除畫布
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()
Ace3 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )
# 從 gist 取出程式碼後, 放入 editor 作為 default 程式
def run2():
    # 利用 get 取下 src 變數值
    try:
        url = doc.query["src2"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # 將程式載入編輯區
    Ace3.editor.setValue(prog)
    Ace3.editor.scrollToRow(0)
    Ace3.editor.gotoLine(0)
    # 直接執行程式
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # 按下 run 按鈕
    Ace3.run()

# 執行程式, 顯示輸出結果與清除輸出結果及對應按鈕綁定
doc['kw_run2'].bind('click', Ace3.run)
doc['kw_show_console2'].bind('click', Ace3.show_console)
doc['kw_clear_console2'].bind('click', Ace3.clear_console)
doc['clear_bd2'].bind('click', clear_bd2)
# 呼叫函式執行
run2()
</script>
</p>
<p><!-- add 1 to 100 part2 開始 -->
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace4 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )

# 透過 Ace4 以類別建立一個通用的 button2, 可以在多個案例中將 gist 程導入編輯區

class button2:
    def __init__(self, url):
        self.url = url

    # 記得加入 event 輸入變數
    def do(self,ev):
        Ace4.editor.setValue(open(self.url).read())
        Ace4.editor.scrollToRow(0)
        Ace4.editor.gotoLine(0)
        Ace4.run()

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# 從 gist 取得程式碼
add_src = open(add1to100_url).read()
def add2(ev):
    Ace4.editor.setValue(add_src)
    Ace4.editor.scrollToRow(0)
    Ace4.editor.gotoLine(0)
    Ace4.run()

# id 為 "add1to100part2" 的按鈕點按時, 執行 add 方法
doc["add1to100part2"].bind('click', add2)
# 以下為運用 button2 class 的通用 gist 程式導入區
################################## cango_three_gears start
cango_three_gears_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/cango_three_gears_brython_div2.py"
cango_three_gears = button2(cango_three_gears_url)
doc["cango_three_gears"].bind("click", cango_three_gears.do)
################################## cango_three_gears end
################################## bsnake start
bsnake_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/kmol_snakey.py"
bsnake = button2(bsnake_url)
doc["bsnake"].bind("click", bsnake.do)
################################## bsnake end
################################## aitetris start
aitetris_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/pygame_to_brython_tetris_ai.py"
aitetris = button2(aitetris_url)
doc["aitetris"].bind("click", aitetris.do)
################################## aitetris end
</script>
</p>
<p><!-- add 1 to 100 part2 結束--></p>
<!-- editor2 開始 -->
<p><!-- 用來顯示程式碼的 editor 區域 --></p>
<div id="kw_editor2" style="width: 600px; height: 300px;"></div>
<p><!-- 以下的表單與按鈕與前面的 Javascript doSave 函式以及 FileSaver.min.js 互相配合 --></p>
<p><!-- 存擋表單開始 --></p>
<form><label>Filename: <input id="kw_filename2" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src2', 'kw_filename2');" type="submit" value="Save"/></form>
<p><!-- 存擋表單結束 --></p>
<p></p>
<p><!-- 執行與清除按鈕開始 --></p>
<p><button id="kw_run2">Run</button> <button id="kw_show_console2">Output</button> <button id="kw_clear_console2">清除輸出區</button><button id="clear_bd2">清除繪圖區</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- 執行與清除按鈕結束 --></p>
<p></p>
<p><!-- 程式執行 ouput 區 --></p>
<div style="width: 100%; height: 100%;"><textarea autocomplete="off" id="kw_console2"></textarea></div>
<p><!-- Brython 程式執行的結果, 都以 brython_div1 作為切入位置 --></p>
<div id="brython_div2"></div>
<!-- editor2 結束 --><hr/>
<p></p>
<h2>Pyodide3</h2>
<p>Pyodide3 則在 <a href="https://mde.tw/cp2025/content/Pyodide.html">Pyodide</a> 與 <a href="https://mde.tw/cp2025/content/Pyodide2.html">Pyodide2</a> 頁面架構下，進一步導入 <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py">robot_w_world.py</a>，在既有的水平圍牆 <a href="https://mde.tw/cp2025/reeborg/src/images/north.png">north.png</a> 與垂直圍牆 <a href="https://mde.tw/cp2025/reeborg/src/images/east.png">east.png</a> 檔案之外，加入 <a href="https://mde.tw/cp2025/reeborg/src/images/carrot.png">carrot.png</a>、<a href="https://mde.tw/cp2025/reeborg/src/images/grass.png">grass.png</a> 與 <a href="https://mde.tw/cp2025/reeborg/src/images/pale_grass.png">pale_grass.png</a> 等圖檔。並且擴充可從 URL 讀進 json 格式的 world 變數功能，以便製作出更多元的場景任務，要求機器人執行。</p>
<p>其中 src URL 變數，可以將網路上的機器人控制程式導入 Pyodide3 頁面外，world URL 變數則可以導入源自 <a href="https://mde.tw/reeborg">Reeborg</a> 機器人程式所設定的 json 格式場景。</p>
<p>由於 Reeborg 系統中的 png 圖檔均非透明背景，<a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py">robot_w_world.py</a> 必須利用 HTML 中的 CANVAS，將關鍵的白色背景，以透明的方式顯示。</p>
<p>src URL 變數讀進 <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py">turn_right 程式</a>，而 world URL 變數則讀進 <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/43517f3f54a5ac24d55d5a5cf8d316e6db2f3b65/harvest2.json">harvest2.json</a>，執行<a href="https://mde.tw/cp2025/content/Pyodide3.html?src=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py&amp;world=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/43517f3f54a5ac24d55d5a5cf8d316e6db2f3b65/harvest2.json">結果</a>。</p>
<p>讀進 <a href="https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/1b1c26eca7f5d772c6301bae865efaddb00a87bb/harvest3.json">harvest3.json</a>, 執行<a href="https://mde.tw/cp2025/content/Pyodide3.html?src=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/8ac3ce859d6aec327b7859e091168270d6a951f7/pyodide2_turn_right.py&amp;world=https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/harvest3.json">結果</a>。</p>
<p>
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js"></script>
</p>
<p><button id="version">version</button> <button id="hello_button">hello</button> <button id="add1to100">1 add to 100</button> <button id="robot1">機器人巡邏</button> <button id="free_walk">自由行</button> <button id="numpy_ode">numpy_ode</button></p>
<!-- Ace Editor Scripts -->
<p>
<script src="/static/ace/FileSaver.min.js"></script>
<script src="/static/ace/filereader.js"></script>
<script src="/static/ace/ace.js"></script>
<script src="/static/ace/ext-language_tools.js"></script>
<script src="/static/ace/mode-python.js"></script>
<script src="/static/ace/snippets/python.js"></script>
</p>
<!-- Editor 1 -->
<div id="kw_editor1" style="width: 600px; height: 300px;"></div>
<p><button id="kw_run1">Run</button> <button id="kw_output1">Output</button> <button id="kw_clear_console1">清除輸出區</button> <button onclick="location.reload()">Reload</button></p>
<p><textarea id="kw_console1"></textarea></p>
<div id="pyodide_div1"></div>
<div id="mpl_output1"></div>
<div id="brython_div1"></div>
<hr/>
<p>從 1 累加到 100 part2:</p>
<p><button id="add1to100part2">1 add to 100</button></p>
<!-- Editor 2 -->
<div id="kw_editor2" style="width: 600px; height: 300px;"></div>
<p><button id="kw_run2">Run</button> <button id="kw_output2">Output</button> <button id="kw_clear_console2">清除輸出區</button> <button onclick="location.reload()">Reload</button></p>
<p><textarea id="kw_console2"></textarea></p>
<div id="pyodide_div2"></div>
<div id="mpl_output2"></div>
<div id="brython_div2"></div>
<p>
<script>
function getUrlParam(key) {
  return new URLSearchParams(window.location.search).get(key);
}
function updateUrlParam(key, value) {
  const url = new URL(window.location);
  url.searchParams.set(key, value);
  window.history.replaceState({}, "", url);
}

let pyodide, editor1, editor2;

// 新增：把 robot_w_world.py 寫入 pyodide FS
async function loadRobotModule() {
  const robotUrl = "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/9f43571ec070ea3e24b083525ee27275a96efcc8/robot_w_world.py";
  const r = await fetch(robotUrl);
  if (!r.ok) throw new Error(`載入 robot.py 失敗: ${r.status}`);
  const code = await r.text();
  pyodide.FS.writeFile("/robot.py", code);
  pyodide.runPython(`import sys; sys.path.append("/")`);  // 加入根目錄到 sys.path
}

document.addEventListener("DOMContentLoaded", async () => {
  editor1 = ace.edit("kw_editor1");
  editor1.setTheme("ace/theme/chrome");
  editor1.session.setMode("ace/mode/python");

  editor2 = ace.edit("kw_editor2");
  editor2.setTheme("ace/theme/chrome");
  editor2.session.setMode("ace/mode/python");

  pyodide = await loadPyodide();
  await pyodide.loadPackage(["numpy", "scipy", "matplotlib", "micropip"]);

  // 預先載入 robot.py
  await loadRobotModule();

  // 你現有的 hello() 定義
  const code = `
def hello():
    print("Hello from custom module!")
`;
  pyodide.runPython(code);

  // 這是你之前其他按鈕用的 Gist 連結
  const GIST_ADD1TO100 =
    "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/" +
    "c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py";
  const NUMPY_ODE =
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" +
    "98d582539545b3c9fbfa35dd3e605c506367618e/pyodide_ode_ex1.py";
  const PYODIDE_ROBOT_ANIMATION =
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" +
    "ff833d14181c7e270d37432aa8589f5ecf00e383/pyodide_walk_around2.py";
  const FREE_WALK = 
    "https://gist.githubusercontent.com/mdecycu/ec4bb35dd0769e7a83d2a9fa57878a67/raw/" + "2a66dceb4a1dbdd0c384d4d17453f1e4f03f2493/pyodide_free_walk2.py"

  // 預設載入 GIST_ADD1TO100（或 URL 參數決定）
  const src = getUrlParam("src");
  if (src === PYODIDE_ROBOT_ANIMATION) {
    const robotCode = await fetchCode(PYODIDE_ROBOT_ANIMATION);
    editor1.setValue(robotCode, -1);
    updateUrlParam("src", PYODIDE_ROBOT_ANIMATION);
    runPyodide(editor1, "kw_console1", "brython_div1");
  } else {
    const initialCode = await fetchCode(src || GIST_ADD1TO100);
    editor1.setValue(initialCode, -1);
    runPyodide(editor1, "kw_console1", "brython_div1");
  }

  editor2.setValue("", -1);

  // 按鈕事件
  document.getElementById("version").onclick = () => {
    const vcode = `
import pyodide
import sys
import matplotlib
import numpy
import scipy
print("Pyodide version:", pyodide.__version__)
print("Python version :", sys.version)
print("matplotlib version:", matplotlib.__version__)
print("numpy version:", numpy.__version__)
print("scipy version:", scipy.__version__)
`;
    editor1.setValue(vcode, -1);
    updateUrlParam("src", "inline_version");
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("hello_button").onclick = () => {
    editor1.setValue("hello()", -1);
    updateUrlParam("src", "inline_hello");
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("add1to100").onclick = async () => {
    const c = await fetchCode(GIST_ADD1TO100);
    editor1.setValue(c, -1);
    updateUrlParam("src", GIST_ADD1TO100);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("numpy_ode").onclick = async () => {
    const c = await fetchCode(NUMPY_ODE);
    editor1.setValue(c, -1);
    updateUrlParam("src", NUMPY_ODE);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("robot1").onclick = async () => {
    const rc = await fetchCode(PYODIDE_ROBOT_ANIMATION);
    editor1.setValue(rc, -1);
    updateUrlParam("src", PYODIDE_ROBOT_ANIMATION);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("free_walk").onclick = async () => {
    const rc = await fetchCode(FREE_WALK);
    editor1.setValue(rc, -1);
    updateUrlParam("src", FREE_WALK);
    runPyodide(editor1, "kw_console1", "brython_div1");
  };

  document.getElementById("add1to100part2").onclick = async () => {
    const c = await fetchCode(GIST_ADD1TO100);
    editor2.setValue(c, -1);
    runPyodide(editor2, "kw_console2", "brython_div2");
  };

  document.getElementById("kw_run1").onclick = () =>
    runPyodide(editor1, "kw_console1", "brython_div1");
  document.getElementById("kw_run2").onclick = () =>
    runPyodide(editor2, "kw_console2", "brython_div2");
  document.getElementById("kw_clear_console1").onclick = () =>
    clearOutput("kw_console1", "brython_div1");
  document.getElementById("kw_clear_console2").onclick = () =>
    clearOutput("kw_console2", "brython_div2");
});

// 調整 output textarea 行數
document.getElementById("kw_output1").onclick = () => {
  const ta = document.getElementById("kw_console1");
  ta.rows = "15";
  ta.cols = "70";
  ta.scrollTop = 0;
};
document.getElementById("kw_output2").onclick = () => {
  const ta = document.getElementById("kw_console2");
  ta.rows = "15";
  ta.cols = "70";
  ta.scrollTop = 0;
};

async function fetchCode(url) {
  const r = await fetch(url);
  if (!r.ok) throw new Error(`載入失敗 ${r.status}`);
  return await r.text();
}

function clearOutput(consoleId, divId) {
  document.getElementById(consoleId).value = "";
  document.getElementById(divId).innerHTML = "";
}

async function runPyodide(editor, consoleId, divId) {
  document.getElementById(consoleId).value = "";
  document.getElementById(divId).innerHTML = "";

  await pyodide.runPythonAsync(`
import sys
class JsWriter:
  def write(self, s):
    from js import document
    ta = document.getElementById("${consoleId}")
    ta.value += s
    ta.scrollTop = ta.scrollHeight
sys.stdout = JsWriter()
sys.stderr = JsWriter()
`);

  try {
    await pyodide.runPythonAsync(editor.getValue());
  } catch (e) {
    document.getElementById(consoleId).value += "\\n錯誤：" + e.toString();
  }
}
</script>
</p>